<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phú Tùng & Quỳnh Anh - 20 tháng 07, 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400;1,700&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F5F0;
            /* Màu trắng ngà */
            color: #333;
            line-height: 1.6;
            overflow-x: hidden;
            /* Ngăn cuộn ngang */
        }

        .header-bg {
            background-image: url('https://placehold.co/1920x700/D4BBAA/FFFFFF?text=Phu+Tung+&+Quynh+Anh+Wedding');
            /* Placeholder cho ảnh bìa */
            background-size: cover;
            background-position: center;
            height: 70vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            color: white;
            position: relative;
        }

        .header-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.3);
            /* Lớp phủ tối nhẹ */
        }

        .header-content {
            z-index: 10;
        }

        .header-content h1 {
            font-family: 'Playfair Display', serif;
            font-size: 4.5rem; /* Tối ưu hóa cho mobile */
            line-height: 1.1;
            margin-bottom: 1rem;
            opacity: 0;
            /* Bắt đầu ẩn để tạo hiệu ứng */
            transform: translateY(20px);
            /* Bắt đầu từ dưới lên */
            transition: opacity 1s ease-out, transform 1s ease-out;
        }

        .header-content p {
            font-size: 1.5rem; /* Tối ưu hóa cho mobile */
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 1s ease-out 0.3s, transform 1s ease-out 0.3s;
        }

        .section {
            padding: 2rem 1rem; /* Giảm padding cho mobile */
            max-width: 1200px;
            margin: 0 auto;
            opacity: 0;
            transform: translateY(50px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }

        .section.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        .gallery-item {
            overflow: hidden;
            border-radius: 0.75rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease-in-out;
            cursor: pointer;
            /* Thêm con trỏ để báo hiệu có thể click */
        }

        .gallery-item:hover {
            transform: translateY(-5px);
        }

        /* Loại bỏ chiều cao cố định cho ảnh trong gallery-item vì sẽ dùng aspect ratio của Tailwind */
        .gallery-item img {
            object-fit: cover;
            display: block;
        }

        .event-card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            padding: 1.5rem; /* Giảm padding cho mobile */
            margin-bottom: 1.5rem; /* Giảm margin cho mobile */
            display: flex;
            flex-direction: column;
            gap: 1rem; /* Giảm gap cho mobile */
        }

        .event-card img {
            width: 100%;
            height: 200px; /* Điều chỉnh chiều cao ảnh cho mobile */
            object-fit: cover;
            border-radius: 0.5rem;
        }

        .event-details h3 {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem; /* Tối ưu hóa cho mobile */
            margin-bottom: 0.5rem;
            color: #5C4B51;
        }

        .event-details p {
            margin-bottom: 0.5rem;
            font-size: 1rem; /* Tối ưu hóa cho mobile */
        }

        .event-buttons {
            display: flex;
            gap: 0.75rem; /* Giảm gap cho mobile */
            flex-wrap: wrap;
            justify-content: center; /* Căn giữa các nút trên mobile */
        }

        .event-buttons button {
            background-color: #B48D7D;
            /* Màu nút */
            color: white;
            padding: 0.6rem 1.2rem; /* Giảm padding cho mobile */
            border-radius: 0.5rem;
            transition: background-color 0.3s ease;
            font-weight: 600;
            border: none;
            cursor: pointer;
            flex-grow: 1; /* Cho phép nút mở rộng nếu cần */
            min-width: 120px; /* Đảm bảo kích thước tối thiểu cho nút */
        }

        .event-buttons button:hover {
            background-color: #A37C6C;
        }

        .rsvp-form {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            padding: 1.5rem; /* Giảm padding cho mobile */
            max-width: 700px;
            margin: 1.5rem auto; /* Giảm margin cho mobile */
        }

        .rsvp-form label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #5C4B51;
            font-size: 0.95rem; /* Tối ưu hóa font size */
        }

        .rsvp-form input[type="text"],
        .rsvp-form input[type="email"],
        .rsvp-form input[type="tel"],
        .rsvp-form textarea {
            width: 100%;
            padding: 0.6rem; /* Giảm padding cho mobile */
            margin-bottom: 1rem; /* Giảm margin cho mobile */
            border: 1px solid #ddd;
            border-radius: 0.5rem;
            box-sizing: border-box;
            font-size: 0.9rem; /* Tối ưu hóa font size */
        }

        .rsvp-form .radio-group {
            display: flex;
            flex-direction: column; /* Stack radio buttons vertically on mobile */
            gap: 0.75rem; /* Giảm gap cho mobile */
            margin-bottom: 1rem; /* Giảm margin cho mobile */
        }

        .rsvp-form .radio-group div {
            display: flex;
            align-items: center;
        }

        .rsvp-form .radio-group input[type="radio"] {
            margin-right: 0.5rem;
        }

        .rsvp-form button[type="submit"] {
            background-color: #E96479;
            /* Màu hồng tương tự ảnh */
            color: white;
            padding: 0.8rem 1.5rem; /* Giảm padding cho mobile */
            border-radius: 0.5rem;
            font-size: 1.1rem; /* Tối ưu hóa font size */
            font-weight: 700;
            border: none;
            cursor: pointer;
            width: 100%;
            transition: background-color 0.3s ease;
        }

        .rsvp-form button[type="submit"]:hover {
            background-color: #D4546B;
        }

        /* Responsive adjustments */
        @media (min-width: 768px) {
            .event-section-content {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 2rem;
            }

            .header-content h1 {
                font-size: 6rem;
            }

            .header-content p {
                font-size: 2rem;
            }

            .section {
                padding: 4rem 1rem; /* Khôi phục padding cho desktop */
            }

            .section-title {
                font-size: 3rem; /* Khôi phục font size cho desktop */
                margin-bottom: 3rem;
            }

            /* Loại bỏ chiều cao cố định cho ảnh trong gallery-item trên desktop */
            /* .gallery-item img {
                height: 300px; 
            } */

            .event-card {
                padding: 2rem;
                margin-bottom: 2rem;
                gap: 1.5rem;
            }

            .event-card img {
                height: 250px;
            }

            .event-details h3 {
                font-size: 1.8rem;
            }

            .event-details p {
                font-size: 1.1rem;
            }

            .event-buttons {
                justify-content: flex-start; /* Nút trái trên desktop */
            }

            .rsvp-form {
                padding: 2.5rem;
                margin: 2rem auto;
            }

            .rsvp-form label {
                font-size: 1rem;
            }

            .rsvp-form input[type="text"],
            .rsvp-form input[type="email"],
            .rsvp-form input[type="tel"],
            .rsvp-form textarea {
                padding: 0.75rem;
                margin-bottom: 1.5rem;
                font-size: 1rem;
            }

            .rsvp-form .radio-group {
                flex-direction: row; /* Radio buttons ngang trên desktop */
                gap: 1.5rem;
                margin-bottom: 1.5rem;
            }

            .rsvp-form button[type="submit"] {
                padding: 1rem 2rem;
                font-size: 1.2rem;
            }
        }

        /* Modal (Lightbox) Styles */
        .image-modal {
            display: none;
            /* Hidden by default */
            position: fixed;
            /* Stay in place */
            z-index: 1000;
            /* Sit on top */
            left: 0;
            top: 0;
            width: 100%;
            /* Full width */
            height: 100%;
            /* Full height */
            overflow: auto;
            /* Enable scroll if needed */
            background-color: rgba(0, 0, 0, 0.9);
            /* Black w/ opacity */
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .modal-content {
            position: relative;
            margin: auto;
            display: flex;
            flex-direction: column;
            width: 95%; /* Tăng width cho mobile */
            height: 95%; /* Tăng height cho mobile */
            max-width: 1200px;
            max-height: 90vh; /* Điều chỉnh chiều cao tối đa cho mobile */
            background-color: #000;
            /* Đảm bảo nền đen như hình mẫu */
            border-radius: 0.75rem;
            overflow: hidden;
            /* Cắt nội dung thừa */
            transform: scale(0.8);
            /* Bắt đầu nhỏ hơn để zoom in */
            opacity: 0;
            /* Bắt đầu ẩn để fade in */
            animation: zoomIn 0.4s forwards ease-out;
            /* Thêm hiệu ứng zoom */
        }

        @keyframes zoomIn {
            from {
                transform: scale(0.8);
                opacity: 0;
            }

            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .modal-main-image-container {
            flex-grow: 1;
            /* Cho ảnh chính chiếm hết không gian còn lại */
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            /* Prevent main image from overflowing */
        }

        .modal-main-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            /* Đảm bảo ảnh vừa khung mà không bị cắt */
            display: block;
        }

        .modal-close {
            position: absolute;
            top: 10px; /* Điều chỉnh vị trí nút close cho mobile */
            right: 15px; /* Điều chỉnh vị trí nút close cho mobile */
            color: #f1f1f1;
            font-size: 35px; /* Điều chỉnh kích thước nút close cho mobile */
            font-weight: bold;
            transition: 0.3s;
            cursor: pointer;
            z-index: 1001;
            /* Đảm bảo nút close luôn nằm trên */
        }

        .modal-close:hover,
        .modal-close:focus {
            color: #bbb;
            text-decoration: none;
            cursor: pointer;
        }

        .modal-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 0.5rem; /* Giảm padding cho mobile */
            box-sizing: border-box;
            z-index: 1000;
        }

        .modal-nav button {
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            padding: 0.3rem 0.8rem; /* Giảm padding cho mobile */
            font-size: 1.8rem; /* Giảm font size cho mobile */
            cursor: pointer;
            border-radius: 0.5rem;
            transition: background-color 0.3s ease;
        }

        .modal-nav button:hover {
            background-color: rgba(0, 0, 0, 0.8);
        }

        .modal-thumbnails {
            display: flex;
            justify-content: center;
            padding: 8px 0; /* Giảm padding cho mobile */
            background-color: #222;
            /* Nền cho thumbnail */
            gap: 8px; /* Giảm gap cho mobile */
            overflow-x: auto;
            /* Cho phép cuộn ngang nếu nhiều thumbnail */
            white-space: nowrap;
            scrollbar-width: thin;
            /* Firefox */
            scrollbar-color: #888 #555;
            /* Firefox */
        }

        .modal-thumbnails::-webkit-scrollbar {
            height: 8px;
        }

        .modal-thumbnails::-webkit-scrollbar-track {
            background: #555;
            border-radius: 10px;
        }

        .modal-thumbnails::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }

        .modal-thumbnail-item {
            width: 70px; /* Điều chỉnh kích thước thumbnail cho mobile */
            height: 50px; /* Điều chỉnh kích thước thumbnail cho mobile */
            overflow: hidden;
            border-radius: 5px;
            cursor: pointer;
            opacity: 0.6;
            transition: opacity 0.3s ease, border 0.3s ease;
            flex-shrink: 0;
            /* Ngăn thumbnail co lại */
        }

        .modal-thumbnail-item.active {
            opacity: 1;
            border: 2px solid #E96479;
            /* Màu viền khi active */
        }

        .modal-thumbnail-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Styling for Wishes section */
        #wishesSection {
            background-color: #F8F5F0;
            padding: 2rem 1rem; /* Giảm padding cho mobile */
        }

        .wishes-container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 1.5rem; /* Giảm padding cho mobile */
            border-radius: 0.75rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .wish-item {
            background-color: #f9f9f9;
            padding: 1.2rem; /* Giảm padding cho mobile */
            border-radius: 0.5rem;
            margin-bottom: 1rem; /* Giảm margin cho mobile */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }

        .wish-item:last-child {
            margin-bottom: 0;
        }

        .wish-item .name {
            font-weight: 600;
            color: #5C4B51;
            margin-bottom: 0.4rem; /* Giảm margin cho mobile */
            font-size: 1rem; /* Tối ưu hóa font size */
        }

        .wish-item .message {
            font-style: italic;
            color: #333;
            line-height: 1.5;
            font-size: 0.95rem; /* Tối ưu hóa font size */
        }

        /* Custom alert box */
        .custom-alert {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            z-index: 1000;
            text-align: center;
            font-family: 'Inter', sans-serif;
            max-width: 90%;
            min-width: 280px;
            color: #333;
        }

        .custom-alert p {
            margin-bottom: 15px;
            font-size: 1.1rem;
            color: #333;
        }

        .custom-alert button {
            background-color: #B48D7D;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
        }
    </style>
</head>

<body>
    <!-- Phần tiêu đề -->
    <header class="header-bg">
        <div class="header-content">
            <h1 id="main-title">Phú Tùng & Quỳnh Anh</h1>
            <p id="wedding-date">20 tháng 07, 2025</p>
        </div>
    </header>

    <!-- Album ảnh -->
    <section id="album" class="section">
        <h2 class="section-title">Album Hình Cưới</h2>
        <p class="text-center text-lg italic mb-8">
            "Được ai đó yêu sâu sắc sẽ mang lại cho bạn sức mạnh, trong khi yêu ai đó sâu sắc sẽ cho bạn dũng khí."
        </p>
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-6">
            <!-- 4 ảnh đầu tiên hiển thị mặc định -->
            <div class="gallery-item relative aspect-[3/2]">
                <!-- Sử dụng ảnh DSC00317.jpg. Lý tưởng nhất là ảnh này nên được cắt và tối ưu hóa trước thành 600x400px để tải nhanh và hiển thị tốt nhất -->
                <img class="absolute inset-0 w-full h-full object-cover" src="image/crop/thumbnails/tn_imag1_crop.jpg" alt="Ảnh cưới 1"
                    data-full-src="image/thumbnails/tn_DSC00317.jpg">
            </div>
            <div class="gallery-item relative aspect-[3/2]">
                <img class="absolute inset-0 w-full h-full object-cover" src="image/crop/thumbnails/tn_image2_crop.jpg" alt="Ảnh cưới 2"
                    data-full-src="image/thumbnails/tn_DSC00514.jpg">
            </div>
            <div class="gallery-item relative aspect-[3/2]">
                <img class="absolute inset-0 w-full h-full object-cover" src="image/crop/thumbnails/tn_image3_crop.jpg" alt="Ảnh cưới 3"
                    data-full-src="image/thumbnails/tn_DSC01159.jpg">
            </div>
            <div class="gallery-item relative aspect-[3/2]">
                <img class="absolute inset-0 w-full h-full object-cover" src="image/crop/thumbnails/tn_image4_crop.jpg" alt="Ảnh cưới 4"
                    data-full-src="image/thumbnails/tn_DSC00818.JPG">
            </div>
            <!-- Dynamic additional images can be added here if needed -->
        </div>
        <!-- Nút "Xem thêm" -->
        <div class="text-center mt-8">
            <button id="showMorePhotosBtn"
                class="bg-pink-600 hover:bg-pink-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300 ease-in-out shadow-lg">
                Xem thêm ảnh
            </button>
        </div>
    </section>

    <!-- Sự kiện Cưới -->
    <section id="events" class="section">
        <h2 class="section-title">Sự Kiện Cưới</h2>
        <p class="text-center text-lg mb-8">
            Cảm ơn bạn rất nhiều vì đã gửi những lời chúc mừng tốt đẹp nhất đến đám cưới của chúng tôi!
        </p>
        <div class="event-section-content">
            <div class="event-card">
                <img src="https://placehold.co/600x300/D4BBAA/FFFFFF?text=Tiecp1" alt="Tiệc cưới nhà trai">
                <div class="event-details">
                    <h3>TIỆC CƯỚI NHÀ TRAI</h3>
                    <p><strong>Thời gian:</strong> 17:00 19/07/2025 (tức ngày 25 tháng 6 âm lịch)</p>
                    <p><strong>Địa điểm:</strong> Nhà văn hoá số 2, thôn Giang Xá, Thị Trấn Trạm Trôi, Hoài Đức, Hà Nội
                    </p>
                    <div class="event-buttons">
                        <button
                            onclick="addToCalendar('Nhà trai', 'Nhà văn hoá số 2, thôn Giang Xá, Thị Trấn Trôi, Hoài Đức, Hà Nội', '2025-07-19T17:00:00')">Thêm
                            vào lịch</button>
                        <button
                            onclick="viewMap('Nhà văn hoá số 2, thôn Giang Xá, Thị Trấn Trạm Trôi, Hoài Đức, Hà Nội')">Xem
                            bản đồ</button>
                    </div>
                </div>
            </div>

            <div class="event-card">
                <img src="https://placehold.co/600x300/C5D8CD/FFFFFF?text=Tiecp2" alt="Tiệc cưới nhà gái">
                <div class="event-details">
                    <h3>TIỆC CƯỚI NHÀ GÁI</h3>
                    <p><strong>Thời gian:</strong> 17:00 19/07/2025 (tức ngày 25 tháng 6 âm lịch)</p>
                    <p><strong>Địa điểm:</strong> Nhà văn hoá, thôn Lai Xá, Kim Chung, Hoài Đức, Hà Nội</p>
                    <div class="event-buttons">
                        <button
                            onclick="addToCalendar('Nhà gái', 'Nhà văn hoá, thôn Lai Xá, Kim Chung, Hoài Đức, Hà Nội', '2025-07-19T17:00:00')">Thêm
                            vào lịch</button>
                        <button onclick="viewMap('Nhà văn hoá, thôn Lai Xá, Kim Chung, Hoài Đức, Hà Nội')">Xem bản
                            đồ</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Xác nhận tham gia (RSVP) -->
    <section id="rsvp" class="section">
        <h2 class="section-title">Xác nhận tham gia</h2>
        <p class="text-lg mb-4 text-center">
            Sự hiện diện và tình cảm của mọi người là món quà vô giá, góp phần làm cho ngày cưới của chúng con
            thêm trọn vẹn và ý nghĩa.
        </p>
        <div class="rsvp-form">
            <h3 class="font-playfair text-3xl text-center mb-6 text-pink-600">Hãy cho chúng mình biết bạn sẽ tham dự!
            </h3>
            <p class="text-center text-gray-600 mb-8">
                Vui lòng xác nhận tham gia trực tuyến trước ngày 18 tháng 7 năm 2025
            </p>
            <form id="rsvpForm">
                <label for="fullName">Tên của bạn:</label>
                <input type="text" id="fullName" name="fullName" placeholder="Tên đầy đủ của bạn" required>

                <label for="phone">Số điện thoại:</label>
                <input type="tel" id="phone" name="phone" placeholder="Số điện thoại của bạn">

                <p class="font-semibold mb-2 text-pink-600">Bạn sẽ tham dự tiệc cưới nhà trai hay nhà gái?</p>
                <div class="radio-group">
                    <div>
                        <input type="radio" id="attendBoy" name="attendance" value="Nhà trai" required>
                        <label for="attendBoy">Tiệc cưới nhà trai</label>
                    </div>
                    <div>
                        <input type="radio" id="attendGirl" name="attendance" value="Nhà gái">
                        <label for="attendGirl">Tiệc cưới nhà gái</label>
                    </div>
                    <div>
                        <input type="radio" id="notAttend" name="attendance" value="Không tham dự">
                        <label for="notAttend">Không tham dự</label>
                    </div>
                </div>

                <label for="message">Lời chúc:</label>
                <textarea id="message" name="message" rows="5"
                    placeholder="Gửi lời chúc tốt đẹp nhất của bạn..."></textarea>

                <button type="submit">GỬI XÁC NHẬN</button>
            </form>
        </div>
    </section>

    <!-- Phần hiển thị Lời chúc từ khách mời -->
    <section id="wishesSection" class="section">
        <h2 class="section-title">Lời Chúc từ Khách Mời</h2>
        <div class="wishes-container" id="wishesContainer">
            <!-- Lời chúc sẽ được tải ở đây -->
            <p class="text-center text-gray-500">Đang tải lời chúc...</p>
        </div>
    </section>

    <!-- Phần Lời Cảm Ơn -->
    <section id="thankYouSection" class="section">
        <h2 class="section-title">Lời Cảm Ơn</h2>
        <div class="text-center max-w-2xl mx-auto">
            <p class="text-lg mb-4">
                Phú Tùng và Quỳnh Anh xin gửi lời cảm ơn chân thành nhất đến tất cả quý vị khách quý đã dành thời gian
                đến chung vui và gửi gắm những lời chúc tốt đẹp trong ngày trọng đại của chúng con.
            </p>
            <p class="text-lg font-semibold">
                Xin chân thành cảm ơn!
            </p>
        </div>
    </section>

    <!-- Image Modal (Lightbox) -->
    <div id="imageModal" class="image-modal">
        <span class="modal-close" onclick="closeModal()">&times;</span>
        <div class="modal-content">
            <div class="modal-main-image-container">
                <img id="modalMainImage" class="modal-main-image" src="" alt="Full size image">
            </div>
            <div class="modal-nav">
                <button onclick="changeImage(-1)">&#10094;</button>
                <button onclick="changeImage(1)">&#10095;</button>
            </div>
            <div id="modalThumbnails" class="modal-thumbnails">
                <!-- Thumbnails will be populated by JS -->
            </div>
        </div>
    </div>

    <script>
        // Backend URL (replace with your actual backend URL)
        const beURL = 'https://server.damcuoichungminh.site';

        // Global array to store image data (src, alt, full-src)
        const allImages = [
            // Thay đổi tại đây: Sử dụng hình ảnh DSC00317.jpg cho thumbnail đầu tiên
            { src: "image/crop/thumbnails/tn_imag1_crop.jpg", alt: "Ảnh cưới 1", fullSrc: "image/thumbnails/tn_DSC00317.jpg" },
            { src: "image/crop/thumbnails/tn_image2_crop.jpg", alt: "Ảnh cưới 2", fullSrc: "image/thumbnails/tn_DSC00514.jpg" },
            { src: "image/crop/thumbnails/tn_image3_crop.jpg", alt: "Ảnh cưới 3", fullSrc: "image/thumbnails/tn_DSC01159.jpg" },
            { src: "image/crop/thumbnails/tn_image4_crop.jpg", alt: "Ảnh cưới 4", fullSrc: "image/thumbnails/tn_DSC00818.JPG" },
            { src: "image/thumbnails/tn_DSC00763.JPG", alt: "Ảnh cưới 5", fullSrc: "image/thumbnails/tn_DSC00763.JPG" },
            { src: "image/thumbnails/tn_DSC00674.jpg", alt: "Ảnh cưới 6", fullSrc: "image/thumbnails/tn_DSC00674.jpg" },
            { src: "image/thumbnails/tn_DSC00852.JPG", alt: "Ảnh cưới 7", fullSrc: "image/thumbnails/tn_DSC00852.JPG" },
            { src: "image/thumbnails/tn_F (114.jpg", alt: "Ảnh cưới 8", fullSrc: "image/thumbnails/tn_F (114.jpg" },
            { src: "image/thumbnails/tn_F (63)fix.jpg", alt: "Ảnh cưới 10", fullSrc: "image/thumbnails/tn_F (63)fix.jpg" },
            { src: "image/thumbnails/tn_F (159).jpg", alt: "Ảnh cưới 9", fullSrc: "image/thumbnails/tn_F (159).jpg" },
            
        ];

        let currentImageIndex = 0;
        const modal = document.getElementById('imageModal');
        const modalMainImage = document.getElementById('modalMainImage');
        const modalThumbnailsContainer = document.getElementById('modalThumbnails');
        const galleryItems = document.querySelectorAll('.gallery-item img');

        // Populate gallery items with data-full-src attributes for initial 6 images
        galleryItems.forEach((imgElement, index) => {
            if (index < allImages.length) {
                imgElement.setAttribute('data-full-src', allImages[index].fullSrc);
            }
        });

        // Function to open the modal and display a specific image
        function openModal(index) {
            modal.style.display = 'flex';
            currentImageIndex = index;
            showImage(currentImageIndex);
            populateThumbnails();
            document.body.style.overflow = 'hidden'; // Prevent scrolling when modal is open
        }

        // Function to close the modal
        function closeModal() {
            modal.style.display = 'none';
            document.body.style.overflow = ''; // Restore scrolling
        }

        // Function to show an image in the modal
        function showImage(index) {
            if (index >= 0 && index < allImages.length) {
                modalMainImage.src = allImages[index].fullSrc;
                modalMainImage.alt = allImages[index].alt;

                // Update active thumbnail
                const thumbnails = modalThumbnailsContainer.querySelectorAll('.modal-thumbnail-item');
                thumbnails.forEach((thumb, i) => {
                    if (i === index) {
                        thumb.classList.add('active');
                        // Scroll thumbnail into view if it's not visible
                        thumb.scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
                    } else {
                        thumb.classList.remove('active');
                    }
                });
            }
        }

        // Function to navigate images (next/previous)
        function changeImage(direction) {
            currentImageIndex += direction;
            if (currentImageIndex < 0) {
                currentImageIndex = allImages.length - 1; // Wrap around to end
            } else if (currentImageIndex >= allImages.length) {
                currentImageIndex = 0; // Wrap around to start
            }
            showImage(currentImageIndex);
        }

        // Function to populate thumbnails in the modal
        function populateThumbnails() {
            modalThumbnailsContainer.innerHTML = ''; // Clear existing thumbnails
            allImages.forEach((image, index) => {
                const thumbItem = document.createElement('div');
                thumbItem.className = 'modal-thumbnail-item';
                if (index === currentImageIndex) {
                    thumbItem.classList.add('active');
                }
                const thumbImg = document.createElement('img');
                thumbImg.src = image.src; // Use smaller src for thumbnail
                thumbImg.alt = image.alt;
                thumbItem.appendChild(thumbImg);
                thumbItem.addEventListener('click', () => openModal(index)); // Open modal on thumbnail click
                modalThumbnailsContainer.appendChild(thumbItem);
            });
        }


        // Hàm thêm vào lịch
        window.addToCalendar = function (eventName, location, dateTime) {
            const date = new Date(dateTime);
            const formattedDate = date.toISOString().replace(/-|:|\.\d{3}/g, ''); // Format McClellanMMDDTHHMMSSZ

            const googleCalendarUrl = `https://www.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(eventName)}&dates=${formattedDate}/${formattedDate}&details=${encodeURIComponent('Sự kiện đám cưới của Phú Tùng & Quỳnh Anh')}&location=${encodeURIComponent(location)}&sf=true&output=xml`;
            window.open(googleCalendarUrl, '_blank');
        };

        // Hàm xem bản đồ
        window.viewMap = function (address) {
            const googleMapsUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(address)}`;
            window.open(googleMapsUrl, '_blank');
        };

        // Hàm tải lời chúc từ backend
        async function fetchWishes() {
            const wishesContainer = document.getElementById('wishesContainer');
            if (!wishesContainer) return; // Ensure the element exists

            wishesContainer.innerHTML = '<p class="text-center text-gray-500">Đang tải lời chúc...</p>';
            try {
                // Thay thế bằng URL API của bạn để lấy lời chúc
                const response = await fetch(`${beURL}/api/wishes`);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const wishes = await response.json();

                wishesContainer.innerHTML = ''; // Clear existing wishes
                if (wishes.length === 0) {
                    wishesContainer.innerHTML = '<p class="text-center text-gray-500">Chưa có lời chúc nào.</p>';
                } else {
                    wishes.forEach(wish => {
                        const wishElement = document.createElement('div');
                        wishElement.className = 'wish-item';
                        wishElement.innerHTML = `
                            <p class="name">${wish.fullName || 'Ẩn danh'}:</p>
                            <p class="message">${wish.message || 'Không có lời chúc.'}</p>
                        `;
                        wishesContainer.appendChild(wishElement);
                    });
                }
            } catch (error) {
                console.error("Error fetching wishes:", error);
                wishesContainer.innerHTML = '<p class="text-center text-red-500">Không thể tải lời chúc. Vui lòng thử lại sau.</p>';
            }
        }

        // Xử lý form RSVP
        document.getElementById('rsvpForm').addEventListener('submit', async function (event) {
            event.preventDefault(); // Ngăn chặn form gửi đi mặc định

            const fullNameInput = document.getElementById('fullName');
            const phoneInput = document.getElementById('phone');
            const messageInput = document.getElementById('message');
            const attendanceRadios = document.querySelectorAll('input[name="attendance"]');

            const fullName = fullNameInput.value.trim();
            const phone = phoneInput.value.trim();
            const message = messageInput.value.trim();
            let attendance = '';

            // Validate fullName
            if (fullName === '') {
                showCustomAlert("Vui lòng nhập tên của bạn.");
                fullNameInput.focus();
                return;
            }

            // Validate phone (optional but if provided, must be valid)
            if (phone !== '') {
                // Regex for Vietnamese phone numbers (0XXXXXXXXX or +84XXXXXXXXX)
                const phoneRegex = /^(0|\+84)[3|5|7|8|9][0-9]{8}$/;
                if (!phoneRegex.test(phone)) {
                    showCustomAlert("Số điện thoại không đúng định dạng. Vui lòng nhập 10 số (bắt đầu bằng 0) hoặc định dạng +84 (ví dụ: +84901234567).");
                    phoneInput.focus();
                    return;
                }
            }

            // Validate attendance radio buttons
            let attendanceSelected = false;
            for (const radio of attendanceRadios) {
                if (radio.checked) {
                    attendance = radio.value;
                    attendanceSelected = true;
                    break;
                }
            }
            if (!attendanceSelected) {
                showCustomAlert("Vui lòng chọn bạn sẽ tham dự tiệc cưới nhà trai hay nhà gái.");
                return;
            }

            // Validate message
            if (message === '') {
                showCustomAlert("Vui lòng nhập lời chúc của bạn.");
                messageInput.focus();
                return;
            }

            try {
                // Gửi dữ liệu đến backend Node.js
                const response = await fetch(`${beURL}/api/rsvp`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ fullName, phone, attendance, message })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                console.log("Backend response:", result);

                showCustomAlert("Cảm ơn bạn đã xác nhận tham gia! Thông tin của bạn đã được gửi thành công.");
                this.reset(); // Reset form after successful submission
                fetchWishes(); // Tải lại lời chúc sau khi gửi thành công
            } catch (error) {
                console.error("Error submitting RSVP:", error);
                showCustomAlert("Có lỗi xảy ra khi gửi thông tin. Vui lòng thử lại.");
            }
        });

        // Thay thế alert bằng một modal hoặc popup đẹp hơn
        function showCustomAlert(message) {
            const existingAlert = document.querySelector('.custom-alert');
            if (existingAlert) {
                existingAlert.remove(); // Remove existing alert to prevent duplicates
            }

            const alertBox = document.createElement('div');
            alertBox.className = 'custom-alert';

            const p = document.createElement('p');
            p.textContent = message;

            const closeButton = document.createElement('button');
            closeButton.textContent = 'Đóng';
            closeButton.addEventListener('click', () => {
                document.body.removeChild(alertBox);
            });

            alertBox.appendChild(p);
            alertBox.appendChild(closeButton);
            document.body.appendChild(alertBox);
        }

        // Hiệu ứng cuộn để hiện ra nội dung
        document.addEventListener('DOMContentLoaded', () => {
            const sections = document.querySelectorAll('.section');

            const observerOptions = {
                root: null,
                rootMargin: '0px',
                threshold: 0.1
            };

            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, observerOptions);

            sections.forEach(section => {
                observer.observe(section);
            });

            // Hiệu ứng cho tiêu đề và ngày cưới
            const mainTitle = document.getElementById('main-title');
            const weddingDate = document.getElementById('wedding-date');

            setTimeout(() => {
                mainTitle.style.opacity = '1';
                mainTitle.style.transform = 'translateY(0)';
            }, 500);

            setTimeout(() => {
                weddingDate.style.opacity = '1';
                weddingDate.style.transform = 'translateY(0)';
            }, 800);

            // Logic cho nút "Xem thêm ảnh"
            const showMoreBtn = document.getElementById('showMorePhotosBtn');
            showMoreBtn.addEventListener('click', () => {
                openModal(0); // Open modal, starting with the first image
            });

            // Add click listener to each gallery item to open modal with that image
            document.querySelectorAll('.gallery-item img').forEach((img, index) => {
                img.addEventListener('click', () => {
                    openModal(index);
                });
            });

            // Close modal when clicking outside content (but not on content itself)
            modal.addEventListener('click', (event) => {
                if (event.target === modal) {
                    closeModal();
                }
            });

            // Keyboard navigation for modal
            document.addEventListener('keydown', (event) => {
                if (modal.style.display === 'flex') { // Only active if modal is open
                    if (event.key === 'ArrowLeft') {
                        changeImage(-1);
                    } else if (event.key === 'ArrowRight') {
                        changeImage(1);
                    } else if (event.key === 'Escape') {
                        closeModal();
                    }
                }
            });

            // Fetch wishes when page loads
            fetchWishes();
        });
    </script>
</body>

</html>
